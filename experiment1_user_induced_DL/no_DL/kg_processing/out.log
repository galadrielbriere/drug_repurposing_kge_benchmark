2024-10-31 10:55:58,988 - WARNING - /home/galadriel/anaconda3/envs/benchmark/lib/python3.9/site-packages/torch/__config__.py:10: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 11040). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver. (Triggered internally at ../c10/cuda/CUDAFunctions.cpp:108.)
  return torch._C._show_config()

2024-10-31 10:56:00,539 - WARNING - /home/galadriel/anaconda3/envs/benchmark/lib/python3.9/site-packages/ignite/handlers/checkpoint.py:16: DeprecationWarning: `TorchScript` support for functional optimizers is deprecated and will be removed in a future PyTorch release. Consider using the `torch.compile` optimizer instead.
  from torch.distributed.optim import ZeroRedundancyOptimizer

2024-10-31 10:56:00,563 - INFO - Configuration loaded:
{
    "common": {
        "seed": 42,
        "input_csv": "/home/galadriel/dr_benchmark/knowledge_graph/shep_kg_without_orphan_treatments.csv",
        "out": "/home/galadriel/dr_benchmark/experiment1_user_induced_DL/no_DL/kg_processing/",
        "run_kg_prep": true,
        "run_training": false,
        "run_evaluation": false
    },
    "clean_kg": {
        "remove_duplicates_triplets": true,
        "make_directed": true,
        "make_directed_params": [
            "disease_disease",
            "drug_drug",
            "protein_protein"
        ],
        "check_synonymous_antisynonymous": true,
        "check_synonymous_antisynonymous_params": {
            "theta1": 0.8,
            "theta2": 0.8
        },
        "permute_kg": false,
        "clean_train_set": true,
        "mixed_test": true
    }
}
2024-10-31 10:56:00,563 - INFO - Setting number of threads to 20
2024-10-31 10:56:00,563 - INFO - Loading parameters from /home/galadriel/dr_benchmark/experiment1_user_induced_DL/no_DL/kg_processing/params.yaml
2024-10-31 10:56:00,563 - INFO - Output folder: /home/galadriel/dr_benchmark/experiment1_user_induced_DL/no_DL/kg_processing/
2024-10-31 10:56:00,563 - INFO - Preparing KG...
2024-10-31 10:56:08,803 - WARNING - /home/galadriel/dr_benchmark/dev/kg_processing.py:97: DtypeWarning: Columns (2,6) have mixed types. Specify dtype option on import or set low_memory=False.
  kg_df = pd.read_csv(input_file, sep="\t")[["my_x_id", "my_y_id", "relation"]]

2024-10-31 10:57:55,052 - INFO - Removing duplicated triplets...
  0%|          | 0/30 [00:00<?, ?it/s]  7%|▋         | 2/30 [00:00<00:03,  7.99it/s] 13%|█▎        | 4/30 [00:00<00:02, 10.85it/s] 20%|██        | 6/30 [00:00<00:01, 12.19it/s]2024-10-31 10:57:56,471 - INFO - 52 duplicates found. Keeping 86247 unique triplets for relation 7
 27%|██▋       | 8/30 [00:01<00:04,  4.44it/s]2024-10-31 10:58:03,926 - INFO - 1336314 duplicates found. Keeping 1336314 unique triplets for relation 8
 30%|███       | 9/30 [00:08<00:38,  1.82s/it] 33%|███▎      | 10/30 [00:09<00:28,  1.44s/it]2024-10-31 10:58:04,271 - INFO - 185 duplicates found. Keeping 25468 unique triplets for relation 10
 40%|████      | 12/30 [00:09<00:15,  1.14it/s]2024-10-31 10:58:04,340 - INFO - 70 duplicates found. Keeping 2070 unique triplets for relation 14
 60%|██████    | 18/30 [00:09<00:04,  2.99it/s]2024-10-31 10:58:04,600 - INFO - 16 duplicates found. Keeping 21909 unique triplets for relation 21
 73%|███████▎  | 22/30 [00:09<00:01,  4.43it/s] 83%|████████▎ | 25/30 [00:10<00:01,  4.71it/s] 90%|█████████ | 27/30 [00:10<00:00,  4.61it/s] 97%|█████████▋| 29/30 [00:15<00:00,  1.39it/s]100%|██████████| 30/30 [00:16<00:00,  1.34it/s]100%|██████████| 30/30 [00:16<00:00,  1.86it/s]
2024-10-31 10:59:26,808 - INFO - Checking for synonymous and antisynonymous relations...
  0%|          | 0/30 [00:00<?, ?it/s]  3%|▎         | 1/30 [00:00<00:10,  2.88it/s]  7%|▋         | 2/30 [00:01<00:18,  1.54it/s] 10%|█         | 3/30 [00:01<00:13,  1.96it/s] 13%|█▎        | 4/30 [00:02<00:14,  1.83it/s] 17%|█▋        | 5/30 [00:02<00:15,  1.66it/s] 20%|██        | 6/30 [00:03<00:11,  2.08it/s] 23%|██▎       | 7/30 [00:05<00:25,  1.10s/it] 27%|██▋       | 8/30 [00:06<00:25,  1.15s/it] 30%|███       | 9/30 [00:23<02:09,  6.19s/it] 33%|███▎      | 10/30 [00:24<01:31,  4.58s/it] 37%|███▋      | 11/30 [00:25<01:02,  3.31s/it] 50%|█████     | 15/30 [00:25<00:18,  1.22s/it] 60%|██████    | 18/30 [00:25<00:08,  1.34it/s] 67%|██████▋   | 20/30 [00:25<00:05,  1.77it/s] 73%|███████▎  | 22/30 [00:26<00:04,  1.95it/s] 77%|███████▋  | 23/30 [00:26<00:03,  2.23it/s] 80%|████████  | 24/30 [00:26<00:02,  2.47it/s] 83%|████████▎ | 25/30 [00:31<00:06,  1.28s/it] 87%|████████▋ | 26/30 [00:32<00:04,  1.19s/it] 90%|█████████ | 27/30 [00:33<00:03,  1.07s/it] 93%|█████████▎| 28/30 [00:33<00:01,  1.10it/s] 97%|█████████▋| 29/30 [00:52<00:05,  5.90s/it]100%|██████████| 30/30 [00:56<00:00,  5.23s/it]100%|██████████| 30/30 [00:56<00:00,  1.87s/it]
2024-10-31 11:00:22,870 - INFO - Finding duplicate relations
  0%|          | 0/435 [00:00<?, ?it/s] 11%|█▏        | 50/435 [00:00<00:00, 492.20it/s] 23%|██▎       | 100/435 [00:00<00:00, 489.87it/s] 34%|███▍      | 149/435 [00:00<00:00, 437.61it/s] 45%|████▍     | 194/435 [00:00<00:00, 293.09it/s] 53%|█████▎    | 229/435 [00:01<00:01, 152.56it/s] 60%|█████▉    | 259/435 [00:01<00:01, 174.91it/s] 93%|█████████▎| 403/435 [00:01<00:00, 402.61it/s]100%|██████████| 435/435 [00:01<00:00, 279.31it/s]
2024-10-31 11:00:24,428 - INFO - Duplicate relations: 0
2024-10-31 11:00:24,428 - INFO - Reverse duplicate relations: 0

2024-10-31 11:00:25,648 - INFO - Adding reverse triplets for relations disease_disease, drug_drug, protein_protein...
2024-10-31 11:02:13,751 - INFO - Adding created reverses ['disease_disease', 'drug_drug', 'protein_protein'] to the list of known duplicated relations.
2024-10-31 11:02:13,752 - INFO - Splitting the dataset into train, validation and test sets...
2024-10-31 11:02:55,487 - INFO - Entity coverage verified successfully.
2024-10-31 11:02:55,488 - INFO - Cleaning the train set to avoid data leakage...
2024-10-31 11:02:55,488 - INFO - Step 1: with respect to validation set.
2024-10-31 11:02:55,488 - INFO - Processing relation pair: (4, 30)
2024-10-31 11:05:05,518 - INFO - Found 2826 triplets to remove for relation 30 with reverse 4.
2024-10-31 11:07:15,086 - INFO - Found 2842 reverse triplets to remove for relation 4 with reverse 30.
2024-10-31 11:07:15,086 - INFO - Processing relation pair: (8, 31)
